variables:
  GIT_DEPTH: "0"

stages:
  - mirror

mirror_to_github:
  stage: mirror
  image: bitnami/git:latest
  before_script:
    - git remote remove github 2>/dev/null || true
  script:
    - git config --global user.name "GitLab Mirror Bot"
    - git config --global user.email "mirror@example.com"
    - git remote add github https://alrifqidarmawan:${GITHUB_TOKEN}@github.com/Fantastic-4-projects/backend-pawtner.git
    - git push --mirror github
  tags:
    - github-mirror
  rules:
    - if: '$CI_PIPELINE_SOURCE == "push"'
